{"hash":"2d4737d4d644ce91d8dafa720b76bb228b4fdaa7","data":{"tag":{"id":"php","title":"php","path":"/tag/php/","belongsTo":{"totalCount":1,"pageInfo":{"totalPages":1,"currentPage":1},"edges":[{"node":{"id":"7528a318b479ad3479028e874069c3bb","title":"Upgrade PHP with Homebrew","datetime":"2019-08-12 00:00:00","path":"/upgrade-php-with-homebrew/","content":"<p>Need to update PHP for use with your local development stack? This short guide will run you through how to do just that, as well as upgrading your PHP version in Laravel Valet.</p>\n<h2 id=\"upgrading-php-with-homebrew\"><a href=\"#upgrading-php-with-homebrew\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Upgrading PHP with Homebrew</h2>\n<p>Assuming you already have Homebrew installed </p>\n<p>Update Brew.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">brew update</span></code></pre>\n<p>Install the latest version of PHP.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">brew install php</span></code></pre>\n<p>Alternatively, if you're looking to use a specific version to match your production server version you can add @ then the version number to the end of the formula. So if you wanted to install PHP 7.3, you would use the following command.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">brew install php@7.3</span></code></pre>\n<p>Check which version of PHP you're currently running by using <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">php -v</code>.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">php -v</span>\n\n<span style=\"color: #FFFFFF\">PHP 7.1.30 </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">cli</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">built: Jun 17 2019 08:52:19</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\"> NTS </span><span style=\"color: #89DDFF\">)</span>\n<span style=\"color: #FFFFFF\">Copyright </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">c</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> 1997-2018 The PHP Group</span>\n<span style=\"color: #FFFFFF\">Zend Engine v3.1.0, Copyright </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">c</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> 1998-2018 Zend Technologies</span>\n<span style=\"color: #FFFFFF\">with Zend OPcache v7.1.30, Copyright </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">c</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> 1999-2018, by Zend Technologies</span><span style=\"color: #89DDFF\">`</span></code></pre>\n<p>Unlink your old PHP version from brew by typing the old PHP version minus the minor update number. (In this example's case we are using PHP <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">7.1.30</code>, so we would use PHP <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">7.1</code>)</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">brew unlink php@7.1</span></code></pre>\n<p><strong>Note:</strong> PHP went through a formula update in 2018 where <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">php71</code> is now <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">php@7.1</code> so be sure to try both ways if you're running into issues.</p>\n<p>Link your new PHP version.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">brew link php@7.3</span></code></pre>\n<p><strong>Note:</strong> Replace <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">7.3</code> with whatever version of PHP you want to switch to or remove <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">@7.3</code> completely if you just ran <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">brew install php</code></p>\n<hr>\n<h2 id=\"updating-your-path\"><a href=\"#updating-your-path\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Updating Your $PATH</h2>\n<p>Now that your PHP is updated and linked, make sure your <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">$PATH</code> is properly setup.</p>\n<p>Open <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">~/.bash_profile</code> in your favorite text editor and add the following: (Replace PHP 7.3.7 with whatever version of PHP you're using)</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #464B5D\"># Setting PATH for PHP 7.3</span>\n<span style=\"color: #C792EA\">export</span><span style=\"color: #FFFFFF\"> PATH=</span><span style=\"color: #89DDFF\">\"</span><span style=\"color: #C3E88D\">/usr/local/opt/php@7.3.7/bin:</span><span style=\"color: #89DDFF\">$</span><span style=\"color: #8F93A2\">PATH</span><span style=\"color: #89DDFF\">\"</span>\n<span style=\"color: #C792EA\">export</span><span style=\"color: #FFFFFF\"> PATH=</span><span style=\"color: #89DDFF\">\"</span><span style=\"color: #C3E88D\">/usr/local/opt/php@7.3.7/sbin:</span><span style=\"color: #89DDFF\">$</span><span style=\"color: #8F93A2\">PATH</span><span style=\"color: #89DDFF\">\"</span></code></pre>\n<p><strong>Note</strong>: After modifying your <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">.bash_profile</code> you must fully close out of your terminal and re-launch it for your changes to take effect. Alternatively, you can type <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">source ~/.bash_profile</code> in your terminal for the changes to take effect.</p>\n<hr>\n<h2 id=\"adding-php-packages\"><a href=\"#adding-php-packages\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Adding PHP Packages</h2>\n<p>Homebrew now uses PECL for all PHP packages, you may need to reinstall any packages that were previously managed with Homebrew.</p>\n<p>To find out if you're already using PECL packages type the following command in your terminal to list out any packages that you may have installed.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">pecl list</span></code></pre>\n<p>Install your PECL packages. Imagick is the only one I use, which handles image transformations in Craft CMS. To install it, run the following command</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">pecl install imagick</span></code></pre>\n<p><strong>Note:</strong> To to see a list of all PECL packages, refer to <a href=\"https://pecl.php.net/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://pecl.php.net/</a></p>\n<hr>\n<h2 id=\"configure-php-settings\"><a href=\"#configure-php-settings\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Configure PHP Settings</h2>\n<p>In order to figure out where your php.ini settings are located, run the following command in your terminal.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">php --ini</span></code></pre>\n<p>PHP in Homebrew by default adds a file called <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">php-memory-limits.ini</code> which is in the following location. This will overwrite the settings in the default php.ini and make it easier to move over to a new installation in the future.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">Configuration File </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFFFFF\">php.ini</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #FFFFFF\"> Path: /usr/local/etc/php/7.3</span>\n<span style=\"color: #FFFFFF\">Loaded Configuration File:         /usr/local/etc/php/7.3/php.ini</span>\n<span style=\"color: #FFFFFF\">Scan </span><span style=\"color: #89DDFF\">for</span><span style=\"color: #FFFFFF\"> </span><span style=\"color: #8F93A2\">additional</span><span style=\"color: #FFFFFF\"> .ini files in: /usr/local/etc/php/7.3/conf.d</span>\n<span style=\"color: #FFFFFF\">Additional .ini files parsed:      /usr/local/etc/php/7.3/conf.d/ext-opcache.ini,</span>\n<span style=\"color: #FFFFFF\">/usr/local/etc/php/7.3/conf.d/php-memory-limits.ini</span></code></pre>\n<p>Modify your php-memory-limits.ini file and move over your settings. Below is a list of my personal config file.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">; Max memory per instance</span>\n<span style=\"color: #FFFFFF\">memory_limit = 1024M</span>\n\n<span style=\"color: #FFFFFF\">;Set the max ececution time of a script.</span>\n<span style=\"color: #FFFFFF\">max_execution_time = 300</span>\n\n<span style=\"color: #FFFFFF\">;The maximum size of an uploaded file.</span>\n<span style=\"color: #FFFFFF\">upload_max_filesize = 128M</span>\n\n<span style=\"color: #FFFFFF\">;Sets max size of post data allowed. This setting also affects file upload. To upload large files, this value must be larger than upload_max_filesize</span>\n<span style=\"color: #FFFFFF\">post_max_size = 128M</span></code></pre>\n<h2 id=\"upgrading-valet\"><a href=\"#upgrading-valet\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Upgrading Valet</h2>\n<p>If you use Laravel Valet for all your local development, here are the steps to finish upgrading PHP. Run the following commands to update Valet in your terminal:</p>\n<p>Update all composer files. </p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">composer global update</span></code></pre>\n<p>Run the install script for Valet.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">valet install</span></code></pre>\n<p>Restart Valet by running the restart script.</p>\n<pre class=\"shiki\" style=\"background-color: #0F111A\"><code><span style=\"color: #FFFFFF\">valet restart</span></code></pre>\n","excerpt":"","description":"Need to update PHP for use with your local development stack? This short guide will run you through how to do just that, as well as upgrading your PHP version in Laravel Valet.","timeToRead":3,"author":{"id":"bryan-dugan","title":"bryan-dugan","path":"/author/bryan-dugan/"}}}]}}},"context":{}}